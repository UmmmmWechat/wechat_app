### 数据结构

* guide

  * ```javascript
    {
        id: int
        openId: String
        avatar: String,
        realName: String,
        idCard: String,
        gender: ['男'，'女'],
        wechat: String,
        phone: String,
        goodFeedbackRate: int
        introduction: String,
        numOfFinishedOrder: int,
        favorSpots: List<int>
    }
    ```

    ​

* tourist

  * ```javascript
    {
        id: int
        openId: String // 微信服务器给的唯一用户标识
        //avatar: String,
        //name: String,
        //gender: ['男', '女'],
        //finishedOrders: List,
        //ongoingOrders: List,
        //waitingOrders: List
        //invalidOrders: List
    }
    ```

    

* order

  * ```javascript
    {
        id: int
        touristId: int
        guideId: int
        spotId: int
        generatedDate: Date
        travelDate: Date
        message: String // 邀请留言
        state: ['finished', 'waiting', 'ongoing', 'invalid', 'rejected', 'canceled', 'timeout']
        cancelReason: String
        feedback: {
            spotPoint: int
            guidePoint: int
            comment: String // 对这一单的评价
        }
    }
    
    ```

* spot

  * ```javascript
    {
        id: int
        name: String
        location: {
                province: String
                city: String
                region: String
        },
        pictureUrl: String
        introduction: Stirng
        recommendLevel: int
        popularity: int
    }
    ```

    ​



### 接口

* tourist

  * ```javascript
    export default {
        /**
         * 根据id查询自己
         * @param {int} id
         * @param {*} resolve 
         * @param {*} reject 
         */
        queryById (id, resolve, reject) {
           
        },
        
        /**
         * 根据景点查询向导
         * @param {int} spotId 景点ID
         * @param {int} lastIndex
         * @param {*} resolve 
         * @param {*} reject 
         */
        queryGuideBySpot (spotId, lastIndex ,resolve, reject) {
            console.log('in tourist api:' + spot);
            var res = []
            for (let i = 0; i < 10; i++){
                res.push(mockGuide(i));
            }
            resolve(res);
        },
    
        /**
         * 
         * @param {String} keyword
         * @param {int} lastIndex
         * @param {*} resolve 
         * @param {*} reject 
         */
        queryGuideByKeyword (keyword, lastIndex, resolve, reject) {
    
        },
        
        /**
         * 邀请 guide
         * @param {int} touristId 
         * @param {int} spotId 
         * @param {int} guideId 
         * @param {String} message
         * @param {Function} resolve 
         * @param {Function} reject
         * {
         *  orderId
         * }
         */
        inviteGuide (touristId, spotId, guideId, message, resolve, reject) {
    
        },
    
        /**
         * 
         * @param {*} code 
         * @param {*} resolve 
         * @param {*} reject 
         * {
         *  touristId
         * }
         */
        logIn (code, resolve, reject) {
            //
        },
    
        /**
         * 
         * @param {String} touristId 
         * @param {String} state
         * @param {int} lastIndex
         * @param {Function} resolve 
         * @param {Function} reject 
         */
        queryOrders (touristId, state, lastIndex, resolve, reject) {
    
        },
    
        /**
         * 取消一单
         * @param {int} orderId 
         * @param {String} cancelMessage
         * @param {*} resolve 
         * @param {*} reject 
         */
        cancelOrder (orderId, cancelMessage, resolve, reject) {
    
        },
    
        /**
         * 评价一单
         * @param {*} orderId 
         * @param {Feedback} feedback 
         * @param {*} resolve 
         * @param {*} reject
         * feedback: {
         	orderId: int
            spotPoint: int
            guidePoint: int
            comment: String
            } 
         */
        commendOrder (feedback, resolve, reject) {
    
        },
    
         /**
         * 
         * @param {int} touristId 
         * @param {String} keyword 
         * @param {*} resolve
         * @param {*} reject 
         */
        queryOrdersByKeyword (touristId, keyword, resolve, reject) {
            
        }
    }
    ```

* guide

  * ```javascript
    export default {
        /**
         * 查询是否是新的guide
         * @param {string} code 
         * @param {Function} resolve 
         * @param {Function} reject 
         */
        queryIfNew (code, resolve, reject) {
            resolve(true);
        },
    
        /**
         * 
         * @param {Object} form 
         * @param {*} resolve 
         * @param {*} reject 
         * form: {
            realName: '',
            idCard: '',
            gender: '',
            wechat: '',
            phone: '',
            introduction: ' ',
            favorSpots: []
            avatar: file
          }
         */
        signUp (form, resolve, reject) {
            resolve('success');
        },
    
        /**
         * 
         * @param {int} guideId 
         * @param {String} state 
         * @param {int} lastIndex
         * @param {*} resolve 
         * @param {*} reject 
         */
        queryOrders (guideId, state, lastIndex, resolve, reject) {
    
        },
    
        /**
         * 通过一个受邀
         * @param {int} orderId 
         * @param {*} resolve 
         * @param {*} reject 
         * 
         */
        acceptOrder (orderId, resolve, reject) {
    
        },
    
        /**
         * 
         * @param {int} orderId 
         * @param {*} resolve 
         * @param {*} reject 
         */
        rejectOrder (orderId, resolve, reject) {
    
        },
    
        /**
         * 
         * @param {Object} info 
         * @param {*} resolve 
         * @param {*} reject
         * form: {
            wechat: '',
            phone: '',
            favorSpots: []
            avatar: file
          }
         */
        modifyUserInfo (form, resolve, reject) {
    
        },
    
        /**
         * 
         * @param {*} id
         * @param {*} resolve 
         * @param {*} reject
         */
        queryUserInfo (id, resolve, reject) {
    
        },
    
        /**
         * 
         * @param {int} guideId
         * @param {String} keyword 
         * @param {int} lastIndex
         * @param {*} resolve 
         * @param {*} reject 
         * {
         *  "waiting":[{},{},{}],
         *  "ongoing":[{},{},{}],
         *  []
         * }
         */
        queryOrdersByKeyword (guideId, keyword, lastIndex, resolve, reject) {
            
        }
    }
    ```

* spot

  * ```javascript
    export default {
        /**
         * 根据定位查询景点
         * @param {Location} location 
         * @param {int} lastIndex
         * @param {*} resolve 
         * @param {*} reject 
         */
        querySpotsByLocation (location, lastIndex, resolve, reject) {
            console.log(location);
            var result = JSON.parse(json);
            resolve(result);
        },
    
        /**
         * 
         * @param {*} keyword
         * @param {int} keyword 
         * @param {*} resolve 
         * @param {*} reject 
         */
        querySpotsByKeyword (keyword, lastIndex, resolve, reject) {
            
        },
        
        querySpotsByLocationAndKeyword(){
            
        }
    }
    ```

    ​

### 分工

* 前端
  * 已写
    * 角色选择界面
    * guide注册（完善信息）界面
    * tourist主界面 （显示景点）
    * 显示某一景点下的 guide
  * 未写
    * tourist 发送邀请的填写界面
    * tourist查看订单的界面 [ 'waiting', 'ongoing',... ]
    * tourist评价订单的界面
    * 取消订单填写理由的界面
    * 我的游记（已经完成）
    * guide查看订单界面
    * guide查看个人信息
    * guide修改个人信息
    * guide日程表